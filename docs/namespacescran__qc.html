<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran_qc: scran_qc Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran_qc
   </div>
   <div id="projectbrief">Simple quality control on single-cell data</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scran_qc Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Simple quality control for single-cell data.  
<a href="namespacescran__qc.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran__qc_1_1AdtQcBlockedFilters.html">AdtQcBlockedFilters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter on ADT-based QC metrics with blocking.  <a href="classscran__qc_1_1AdtQcBlockedFilters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran__qc_1_1AdtQcFilters.html">AdtQcFilters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter for high-quality cells using ADT-based metrics.  <a href="classscran__qc_1_1AdtQcFilters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html">ChooseFilterThresholdsOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran__qc.html#aeee603882324b072b88a6f641ffcc2e6">choose_filter_thresholds()</a></code>.  <a href="structscran__qc_1_1ChooseFilterThresholdsOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ChooseFilterThresholdsResults.html">ChooseFilterThresholdsResults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Results of <code><a class="el" href="namespacescran__qc.html#ac96495884db86cf7ecefb3635f649cd3">compute_adt_qc_metrics()</a></code>.  <a href="structscran__qc_1_1ChooseFilterThresholdsResults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeAdtQcFiltersOptions.html">ComputeAdtQcFiltersOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran__qc.html#a4e0708c006f7362c4ca7587802293e01">compute_adt_qc_filters()</a></code>.  <a href="structscran__qc_1_1ComputeAdtQcFiltersOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsBuffers.html">ComputeAdtQcMetricsBuffers</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffers for <code><a class="el" href="namespacescran__qc.html#ac96495884db86cf7ecefb3635f649cd3">compute_adt_qc_metrics()</a></code>.  <a href="structscran__qc_1_1ComputeAdtQcMetricsBuffers.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsOptions.html">ComputeAdtQcMetricsOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran__qc.html#ac96495884db86cf7ecefb3635f649cd3">compute_adt_qc_metrics()</a></code>.  <a href="structscran__qc_1_1ComputeAdtQcMetricsOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsResults.html">ComputeAdtQcMetricsResults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Results of <code><a class="el" href="namespacescran__qc.html#ac96495884db86cf7ecefb3635f649cd3">compute_adt_qc_metrics()</a></code>.  <a href="structscran__qc_1_1ComputeAdtQcMetricsResults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeCrisprQcFiltersOptions.html">ComputeCrisprQcFiltersOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran__qc.html#adf29d5d3e3d5c698710b139f626c8ce0">compute_crispr_qc_filters()</a></code>.  <a href="structscran__qc_1_1ComputeCrisprQcFiltersOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsBuffers.html">ComputeCrisprQcMetricsBuffers</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffers for <code><a class="el" href="namespacescran__qc.html#a9d57853e7f9d53acbe63649f19a1ab72">compute_crispr_qc_metrics()</a></code>.  <a href="structscran__qc_1_1ComputeCrisprQcMetricsBuffers.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsOptions.html">ComputeCrisprQcMetricsOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran__qc.html#a9d57853e7f9d53acbe63649f19a1ab72">compute_crispr_qc_metrics()</a></code>.  <a href="structscran__qc_1_1ComputeCrisprQcMetricsOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsResults.html">ComputeCrisprQcMetricsResults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Results of <code><a class="el" href="namespacescran__qc.html#a9d57853e7f9d53acbe63649f19a1ab72">compute_crispr_qc_metrics()</a></code>.  <a href="structscran__qc_1_1ComputeCrisprQcMetricsResults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeRnaQcFiltersOptions.html">ComputeRnaQcFiltersOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran__qc.html#af13df69a88ca429bcf8333d61bfb5802">compute_rna_qc_filters()</a></code>.  <a href="structscran__qc_1_1ComputeRnaQcFiltersOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsBuffers.html">ComputeRnaQcMetricsBuffers</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffers for <code><a class="el" href="namespacescran__qc.html#a11547d21005ac59afdfa595581c534bc">compute_rna_qc_metrics()</a></code>.  <a href="structscran__qc_1_1ComputeRnaQcMetricsBuffers.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsOptions.html">ComputeRnaQcMetricsOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran__qc.html#a11547d21005ac59afdfa595581c534bc">compute_rna_qc_metrics()</a></code>.  <a href="structscran__qc_1_1ComputeRnaQcMetricsOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsResults.html">ComputeRnaQcMetricsResults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Results of <code><a class="el" href="namespacescran__qc.html#a11547d21005ac59afdfa595581c534bc">compute_rna_qc_metrics()</a></code>.  <a href="structscran__qc_1_1ComputeRnaQcMetricsResults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran__qc_1_1CrisprQcBlockedFilters.html">CrisprQcBlockedFilters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter on using CRISPR-based QC metrics with blocking.  <a href="classscran__qc_1_1CrisprQcBlockedFilters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran__qc_1_1CrisprQcFilters.html">CrisprQcFilters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter for high-quality cells using CRISPR-based metrics.  <a href="classscran__qc_1_1CrisprQcFilters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1FindMedianMadOptions.html">FindMedianMadOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran__qc.html#aa258344640d79468c00a2c96c9e1bf1f">find_median_mad()</a></code>.  <a href="structscran__qc_1_1FindMedianMadOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1FindMedianMadResults.html">FindMedianMadResults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Results of <code><a class="el" href="namespacescran__qc.html#aa258344640d79468c00a2c96c9e1bf1f">find_median_mad()</a></code>.  <a href="structscran__qc_1_1FindMedianMadResults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">FindMedianMadWorkspace</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporary data structures for <code><a class="el" href="namespacescran__qc.html#af2fb034bba1a588f7b007fbf95ffe370">find_median_mad_blocked()</a></code>.  <a href="classscran__qc_1_1FindMedianMadWorkspace.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1PerCellQcMetricsBuffers.html">PerCellQcMetricsBuffers</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffers for <code><a class="el" href="namespacescran__qc.html#ade78b2da5f4df8f7079570cb5e750513">per_cell_qc_metrics()</a></code>.  <a href="structscran__qc_1_1PerCellQcMetricsBuffers.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1PerCellQcMetricsOptions.html">PerCellQcMetricsOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran__qc.html#ade78b2da5f4df8f7079570cb5e750513">per_cell_qc_metrics()</a></code>.  <a href="structscran__qc_1_1PerCellQcMetricsOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__qc_1_1PerCellQcMetricsResults.html">PerCellQcMetricsResults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Result store for QC metric calculations.  <a href="structscran__qc_1_1PerCellQcMetricsResults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran__qc_1_1RnaQcBlockedFilters.html">RnaQcBlockedFilters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter for high-quality cells using RNA-based metrics with blocking.  <a href="classscran__qc_1_1RnaQcBlockedFilters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran__qc_1_1RnaQcFilters.html">RnaQcFilters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter for high-quality cells using RNA-based metrics.  <a href="classscran__qc_1_1RnaQcFilters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac96495884db86cf7ecefb3635f649cd3" id="r_ac96495884db86cf7ecefb3635f649cd3"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; </td></tr>
<tr class="memitem:ac96495884db86cf7ecefb3635f649cd3"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#ac96495884db86cf7ecefb3635f649cd3">compute_adt_qc_metrics</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">mat</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">subsets</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsBuffers.html">ComputeAdtQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">output</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsOptions.html">ComputeAdtQcMetricsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:ac96495884db86cf7ecefb3635f649cd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb922c5e6e7e7beda72ed64200231fc" id="r_a4bb922c5e6e7e7beda72ed64200231fc"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a>  = const uint8_t*&gt; </td></tr>
<tr class="memitem:a4bb922c5e6e7e7beda72ed64200231fc"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsResults.html">ComputeAdtQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a4bb922c5e6e7e7beda72ed64200231fc">compute_adt_qc_metrics</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">mat</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">subsets</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsOptions.html">ComputeAdtQcMetricsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a4bb922c5e6e7e7beda72ed64200231fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e0708c006f7362c4ca7587802293e01" id="r_a4e0708c006f7362c4ca7587802293e01"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; </td></tr>
<tr class="memitem:a4e0708c006f7362c4ca7587802293e01"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1AdtQcFilters.html">AdtQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a4e0708c006f7362c4ca7587802293e01">compute_adt_qc_filters</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsBuffers.html">ComputeAdtQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcFiltersOptions.html">ComputeAdtQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a4e0708c006f7362c4ca7587802293e01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7984fd78d63b52283aeb3be2e2d1e234" id="r_a7984fd78d63b52283aeb3be2e2d1e234"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; </td></tr>
<tr class="memitem:a7984fd78d63b52283aeb3be2e2d1e234"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1AdtQcFilters.html">AdtQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a7984fd78d63b52283aeb3be2e2d1e234">compute_adt_qc_filters</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsResults.html">ComputeAdtQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcFiltersOptions.html">ComputeAdtQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a7984fd78d63b52283aeb3be2e2d1e234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a6f3d70501f5b3bcac0f44cbc82349" id="r_a47a6f3d70501f5b3bcac0f44cbc82349"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </td></tr>
<tr class="memitem:a47a6f3d70501f5b3bcac0f44cbc82349"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1AdtQcBlockedFilters.html">AdtQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a47a6f3d70501f5b3bcac0f44cbc82349">compute_adt_qc_filters_blocked</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsBuffers.html">ComputeAdtQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">block</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcFiltersOptions.html">ComputeAdtQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a47a6f3d70501f5b3bcac0f44cbc82349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef98343dad6aec5aa287f35fe6a6515" id="r_aeef98343dad6aec5aa287f35fe6a6515"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </td></tr>
<tr class="memitem:aeef98343dad6aec5aa287f35fe6a6515"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1AdtQcBlockedFilters.html">AdtQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#aeef98343dad6aec5aa287f35fe6a6515">compute_adt_qc_filters_blocked</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsResults.html">ComputeAdtQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">block</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcFiltersOptions.html">ComputeAdtQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:aeef98343dad6aec5aa287f35fe6a6515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeee603882324b072b88a6f641ffcc2e6" id="r_aeee603882324b072b88a6f641ffcc2e6"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </td></tr>
<tr class="memitem:aeee603882324b072b88a6f641ffcc2e6"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran__qc_1_1ChooseFilterThresholdsResults.html">ChooseFilterThresholdsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#aeee603882324b072b88a6f641ffcc2e6">choose_filter_thresholds</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1FindMedianMadResults.html">FindMedianMadResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">mm</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html">ChooseFilterThresholdsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:aeee603882324b072b88a6f641ffcc2e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae36c76ebd4e27574da1e12241a16d625" id="r_ae36c76ebd4e27574da1e12241a16d625"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </td></tr>
<tr class="memitem:ae36c76ebd4e27574da1e12241a16d625"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran__qc_1_1ChooseFilterThresholdsResults.html">ChooseFilterThresholdsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#ae36c76ebd4e27574da1e12241a16d625">choose_filter_thresholds</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html">ChooseFilterThresholdsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:ae36c76ebd4e27574da1e12241a16d625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d9a36257fb0f4f4a7d9a2f75af17e43" id="r_a0d9a36257fb0f4f4a7d9a2f75af17e43"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </td></tr>
<tr class="memitem:a0d9a36257fb0f4f4a7d9a2f75af17e43"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran__qc_1_1ChooseFilterThresholdsResults.html">ChooseFilterThresholdsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a0d9a36257fb0f4f4a7d9a2f75af17e43">choose_filter_thresholds</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">buffer</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html">ChooseFilterThresholdsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a0d9a36257fb0f4f4a7d9a2f75af17e43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e8af19093a60909e202bb614bbacbeb" id="r_a8e8af19093a60909e202bb614bbacbeb"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </td></tr>
<tr class="memitem:a8e8af19093a60909e202bb614bbacbeb"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsResults.html">ChooseFilterThresholdsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a8e8af19093a60909e202bb614bbacbeb">choose_filter_thresholds_blocked</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="structscran__qc_1_1FindMedianMadResults.html">FindMedianMadResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; &gt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">mms</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html">ChooseFilterThresholdsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a8e8af19093a60909e202bb614bbacbeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc052211c623c1226049a2ee24f098fe" id="r_acc052211c623c1226049a2ee24f098fe"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </td></tr>
<tr class="memitem:acc052211c623c1226049a2ee24f098fe"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsResults.html">ChooseFilterThresholdsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#acc052211c623c1226049a2ee24f098fe">choose_filter_thresholds_blocked</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">block</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">FindMedianMadWorkspace</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">workspace</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html">ChooseFilterThresholdsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:acc052211c623c1226049a2ee24f098fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d57853e7f9d53acbe63649f19a1ab72" id="r_a9d57853e7f9d53acbe63649f19a1ab72"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; </td></tr>
<tr class="memitem:a9d57853e7f9d53acbe63649f19a1ab72"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a9d57853e7f9d53acbe63649f19a1ab72">compute_crispr_qc_metrics</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">mat</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsBuffers.html">ComputeCrisprQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">output</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsOptions.html">ComputeCrisprQcMetricsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a9d57853e7f9d53acbe63649f19a1ab72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbaf45a235b43cb053d64d0106928459" id="r_adbaf45a235b43cb053d64d0106928459"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>  = int&gt; </td></tr>
<tr class="memitem:adbaf45a235b43cb053d64d0106928459"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsResults.html">ComputeCrisprQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#adbaf45a235b43cb053d64d0106928459">compute_crispr_qc_metrics</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">mat</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsOptions.html">ComputeCrisprQcMetricsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:adbaf45a235b43cb053d64d0106928459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf29d5d3e3d5c698710b139f626c8ce0" id="r_adf29d5d3e3d5c698710b139f626c8ce0"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; </td></tr>
<tr class="memitem:adf29d5d3e3d5c698710b139f626c8ce0"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1CrisprQcFilters.html">CrisprQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#adf29d5d3e3d5c698710b139f626c8ce0">compute_crispr_qc_filters</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsBuffers.html">ComputeCrisprQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcFiltersOptions.html">ComputeCrisprQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:adf29d5d3e3d5c698710b139f626c8ce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c7e9cfdd12acb3e582ac5246af5d3eb" id="r_a3c7e9cfdd12acb3e582ac5246af5d3eb"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>  = int&gt; </td></tr>
<tr class="memitem:a3c7e9cfdd12acb3e582ac5246af5d3eb"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1CrisprQcFilters.html">CrisprQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a3c7e9cfdd12acb3e582ac5246af5d3eb">compute_crispr_qc_filters</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsResults.html">ComputeCrisprQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcFiltersOptions.html">ComputeCrisprQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a3c7e9cfdd12acb3e582ac5246af5d3eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be1a5e698e0b3a8f79c3966d971fe81" id="r_a2be1a5e698e0b3a8f79c3966d971fe81"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </td></tr>
<tr class="memitem:a2be1a5e698e0b3a8f79c3966d971fe81"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1CrisprQcBlockedFilters.html">CrisprQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a2be1a5e698e0b3a8f79c3966d971fe81">compute_crispr_qc_filters_blocked</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsBuffers.html">ComputeCrisprQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">block</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcFiltersOptions.html">ComputeCrisprQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a2be1a5e698e0b3a8f79c3966d971fe81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7f1c65c4e6fc533e4a3ca082e00d3f" id="r_aca7f1c65c4e6fc533e4a3ca082e00d3f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </td></tr>
<tr class="memitem:aca7f1c65c4e6fc533e4a3ca082e00d3f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1CrisprQcBlockedFilters.html">CrisprQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#aca7f1c65c4e6fc533e4a3ca082e00d3f">compute_crispr_qc_filters_blocked</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsResults.html">ComputeCrisprQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">block</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcFiltersOptions.html">ComputeCrisprQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:aca7f1c65c4e6fc533e4a3ca082e00d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa258344640d79468c00a2c96c9e1bf1f" id="r_aa258344640d79468c00a2c96c9e1bf1f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </td></tr>
<tr class="memitem:aa258344640d79468c00a2c96c9e1bf1f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran__qc_1_1FindMedianMadResults.html">FindMedianMadResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#aa258344640d79468c00a2c96c9e1bf1f">find_median_mad</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1FindMedianMadOptions.html">FindMedianMadOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:aa258344640d79468c00a2c96c9e1bf1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51ca245d47de05acbb806ae736248d18" id="r_a51ca245d47de05acbb806ae736248d18"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> &gt; </td></tr>
<tr class="memitem:a51ca245d47de05acbb806ae736248d18"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran__qc_1_1FindMedianMadResults.html">FindMedianMadResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a51ca245d47de05acbb806ae736248d18">find_median_mad</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">buffer</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1FindMedianMadOptions.html">FindMedianMadOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a51ca245d47de05acbb806ae736248d18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2fb034bba1a588f7b007fbf95ffe370" id="r_af2fb034bba1a588f7b007fbf95ffe370"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </td></tr>
<tr class="memitem:af2fb034bba1a588f7b007fbf95ffe370"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structscran__qc_1_1FindMedianMadResults.html">FindMedianMadResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a> &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#af2fb034bba1a588f7b007fbf95ffe370">find_median_mad_blocked</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">block</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">FindMedianMadWorkspace</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">workspace</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1FindMedianMadOptions.html">FindMedianMadOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:af2fb034bba1a588f7b007fbf95ffe370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50cadfe67abc7398be1645988e3be3a7" id="r_a50cadfe67abc7398be1645988e3be3a7"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> &gt; </td></tr>
<tr class="memitem:a50cadfe67abc7398be1645988e3be3a7"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a50cadfe67abc7398be1645988e3be3a7">filter_index</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> *filter, std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">output</a>)</td></tr>
<tr class="separator:a50cadfe67abc7398be1645988e3be3a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3afc89c4d5b58f290c88a1992dddaf0f" id="r_a3afc89c4d5b58f290c88a1992dddaf0f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> &gt; </td></tr>
<tr class="memitem:a3afc89c4d5b58f290c88a1992dddaf0f"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a3afc89c4d5b58f290c88a1992dddaf0f">filter_index</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> *filter)</td></tr>
<tr class="separator:a3afc89c4d5b58f290c88a1992dddaf0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30925d34e2091b9e5fdf2b1cbff866e7" id="r_a30925d34e2091b9e5fdf2b1cbff866e7"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a> &gt; </td></tr>
<tr class="memitem:a30925d34e2091b9e5fdf2b1cbff866e7"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a30925d34e2091b9e5fdf2b1cbff866e7">combine_filters</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> * &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">filters</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">output</a>)</td></tr>
<tr class="separator:a30925d34e2091b9e5fdf2b1cbff866e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedcaf6807fab07ce2cbd170a57c84f85" id="r_aedcaf6807fab07ce2cbd170a57c84f85"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a>  = uint8_t, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a>  = uint8_t&gt; </td></tr>
<tr class="memitem:aedcaf6807fab07ce2cbd170a57c84f85"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#aedcaf6807fab07ce2cbd170a57c84f85">combine_filters</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> * &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">filters</a>)</td></tr>
<tr class="separator:aedcaf6807fab07ce2cbd170a57c84f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8af35779ffe55f2cb003e5bbed71e175" id="r_a8af35779ffe55f2cb003e5bbed71e175"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> &gt; </td></tr>
<tr class="memitem:a8af35779ffe55f2cb003e5bbed71e175"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a8af35779ffe55f2cb003e5bbed71e175">combine_filters_index</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> * &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">filters</a>, std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">output</a>)</td></tr>
<tr class="separator:a8af35779ffe55f2cb003e5bbed71e175"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dc9944048c61d5befb96a19c04e1b8b" id="r_a5dc9944048c61d5befb96a19c04e1b8b"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> &gt; </td></tr>
<tr class="memitem:a5dc9944048c61d5befb96a19c04e1b8b"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a5dc9944048c61d5befb96a19c04e1b8b">combine_filters_index</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> * &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">filters</a>)</td></tr>
<tr class="separator:a5dc9944048c61d5befb96a19c04e1b8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade78b2da5f4df8f7079570cb5e750513" id="r_ade78b2da5f4df8f7079570cb5e750513"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; </td></tr>
<tr class="memitem:ade78b2da5f4df8f7079570cb5e750513"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#ade78b2da5f4df8f7079570cb5e750513">per_cell_qc_metrics</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">mat</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">subsets</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1PerCellQcMetricsBuffers.html">PerCellQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">output</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1PerCellQcMetricsOptions.html">PerCellQcMetricsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:ade78b2da5f4df8f7079570cb5e750513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdd64a6af25caaab6bef69ccfb26b49c" id="r_acdd64a6af25caaab6bef69ccfb26b49c"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; </td></tr>
<tr class="memitem:acdd64a6af25caaab6bef69ccfb26b49c"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran__qc_1_1PerCellQcMetricsResults.html">PerCellQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#acdd64a6af25caaab6bef69ccfb26b49c">per_cell_qc_metrics</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">mat</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">subsets</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1PerCellQcMetricsOptions.html">PerCellQcMetricsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:acdd64a6af25caaab6bef69ccfb26b49c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11547d21005ac59afdfa595581c534bc" id="r_a11547d21005ac59afdfa595581c534bc"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; </td></tr>
<tr class="memitem:a11547d21005ac59afdfa595581c534bc"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a11547d21005ac59afdfa595581c534bc">compute_rna_qc_metrics</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">mat</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">subsets</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsBuffers.html">ComputeRnaQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">output</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsOptions.html">ComputeRnaQcMetricsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a11547d21005ac59afdfa595581c534bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10981f9d0493eb03130bc2985ce702ff" id="r_a10981f9d0493eb03130bc2985ce702ff"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a>  = const uint8_t*&gt; </td></tr>
<tr class="memitem:a10981f9d0493eb03130bc2985ce702ff"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsResults.html">ComputeRnaQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a10981f9d0493eb03130bc2985ce702ff">compute_rna_qc_metrics</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">mat</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">subsets</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsOptions.html">ComputeRnaQcMetricsOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a10981f9d0493eb03130bc2985ce702ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af13df69a88ca429bcf8333d61bfb5802" id="r_af13df69a88ca429bcf8333d61bfb5802"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a>  = double&gt; </td></tr>
<tr class="memitem:af13df69a88ca429bcf8333d61bfb5802"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1RnaQcFilters.html">RnaQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#af13df69a88ca429bcf8333d61bfb5802">compute_rna_qc_filters</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsBuffers.html">ComputeRnaQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcFiltersOptions.html">ComputeRnaQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:af13df69a88ca429bcf8333d61bfb5802"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a661f34a170913e18ce0e23e82b83899a" id="r_a661f34a170913e18ce0e23e82b83899a"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a>  = double&gt; </td></tr>
<tr class="memitem:a661f34a170913e18ce0e23e82b83899a"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1RnaQcFilters.html">RnaQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#a661f34a170913e18ce0e23e82b83899a">compute_rna_qc_filters</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsResults.html">ComputeRnaQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcFiltersOptions.html">ComputeRnaQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:a661f34a170913e18ce0e23e82b83899a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3ce8f1830515304cde4417dd26cb8a6" id="r_ad3ce8f1830515304cde4417dd26cb8a6"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </td></tr>
<tr class="memitem:ad3ce8f1830515304cde4417dd26cb8a6"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1RnaQcBlockedFilters.html">RnaQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#ad3ce8f1830515304cde4417dd26cb8a6">compute_rna_qc_filters_blocked</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">num</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsBuffers.html">ComputeRnaQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">block</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcFiltersOptions.html">ComputeRnaQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:ad3ce8f1830515304cde4417dd26cb8a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6123dbe90d91d7c6bf8200ed582e10f" id="r_ad6123dbe90d91d7c6bf8200ed582e10f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </td></tr>
<tr class="memitem:ad6123dbe90d91d7c6bf8200ed582e10f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran__qc_1_1RnaQcBlockedFilters.html">RnaQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__qc.html#ad6123dbe90d91d7c6bf8200ed582e10f">compute_rna_qc_filters_blocked</a> (<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsResults.html">ComputeRnaQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">metrics</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">block</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcFiltersOptions.html">ComputeRnaQcFiltersOptions</a> &amp;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">options</a>)</td></tr>
<tr class="separator:ad6123dbe90d91d7c6bf8200ed582e10f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Simple quality control for single-cell data. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac96495884db86cf7ecefb3635f649cd3" name="ac96495884db86cf7ecefb3635f649cd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac96495884db86cf7ecefb3635f649cd3">&#9670;&#160;</a></span>compute_adt_qc_metrics() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a> scran_qc::compute_adt_qc_metrics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsBuffers.html">ComputeAdtQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsOptions.html">ComputeAdtQcMetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a feature-by-cell ADT count matrix, this function uses <code><a class="el" href="namespacescran__qc.html#ade78b2da5f4df8f7079570cb5e750513">per_cell_qc_metrics()</a></code> to compute several ADT-relevant QC metrics:</p>
<ul>
<li>The sum of counts for each cell, which (in theory) represents the efficiency of library preparation and sequencing. This is less useful as a QC metric for ADT data given that the sum is strongly influenced by biological variation in the abundance of the targeted features. Nonetheless, we compute it for diagnostic purposes.</li>
<li>The number of detected tags per cell. Even though ADTs are commonly applied in situations where few features are highly abundant, we still expect detectable coverage of most features due to ambient contamination, non-specific binding or some background expression. The absence of detectable coverage indicates that library preparation or sequencing depth was suboptimal.</li>
<li>The sum of counts in pre-defined feature subsets. While the exact interpretation depends on the nature of the subset, the most common use case involves isotype control (IgG) features. IgG antibodies should not bind to anything, so high coverage suggests that non-specific binding is a problem, e.g., due to antibody conjugates.</li>
</ul>
<p>We use these metrics to define thresholds for filtering in <code><a class="el" href="namespacescran__qc.html#a4e0708c006f7362c4ca7587802293e01">compute_adt_qc_filters()</a></code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>A <b>tatami</b> matrix containing count data. Rows correspond to ADT features while columns correspond to cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subsets</td><td>Vector of feature subsets, typically IgG controls. See <code><a class="el" href="namespacescran__qc.html#ade78b2da5f4df8f7079570cb5e750513">per_cell_qc_metrics()</a></code> for more details on the expected format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td><code><a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsBuffers.html" title="Buffers for compute_adt_qc_metrics().">ComputeAdtQcMetricsBuffers</a></code> object in which to store the output. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4bb922c5e6e7e7beda72ed64200231fc" name="a4bb922c5e6e7e7beda72ed64200231fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bb922c5e6e7e7beda72ed64200231fc">&#9670;&#160;</a></span>compute_adt_qc_metrics() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a>  = const uint8_t*&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsResults.html">ComputeAdtQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; scran_qc::compute_adt_qc_metrics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsOptions.html">ComputeAdtQcMetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran__qc.html#ac96495884db86cf7ecefb3635f649cd3">compute_adt_qc_metrics()</a></code> that allocates memory for the results.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>A <b>tatami</b> matrix containing count data. Rows correspond to ADT features while columns correspond to cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subsets</td><td>Vector of feature subsets, typically IgG controls. See <code><a class="el" href="namespacescran__qc.html#ade78b2da5f4df8f7079570cb5e750513">per_cell_qc_metrics()</a></code> for more details on the expected format. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An object containing the QC metrics. </dd></dl>

</div>
</div>
<a id="a4e0708c006f7362c4ca7587802293e01" name="a4e0708c006f7362c4ca7587802293e01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e0708c006f7362c4ca7587802293e01">&#9670;&#160;</a></span>compute_adt_qc_filters() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1AdtQcFilters.html">AdtQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_adt_qc_filters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsBuffers.html">ComputeAdtQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcFiltersOptions.html">ComputeAdtQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Using the ADT-relevant QC metrics from <code><a class="el" href="namespacescran__qc.html#ac96495884db86cf7ecefb3635f649cd3">compute_adt_qc_metrics()</a></code>, we consider low-quality cells to be those with a low number of detected tags and high subset sums. We define thresholds for each metric using an MAD-based outlier approach (see <code><a class="el" href="namespacescran__qc.html#aeee603882324b072b88a6f641ffcc2e6">choose_filter_thresholds()</a></code> for details). For the number of detected features and the subset sums, the outliers are defined after log-transformation of the metrics.</p>
<p>For the number of detected features, we supplement the MAD-based threshold with a minimum drop in the proportion from the median. That is, cells are only considered to be low quality if the difference in the number of detected features from the median is greater than a certain percentage. By default, the number must drop by at least 10% from the median. This avoids overly aggressive filtering when the MAD is zero due to the discrete nature of this statistic in datasets with few tags.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramname">metrics</td><td>A collection of arrays containing ADT-based QC metrics, filled by <code><a class="el" href="namespacescran__qc.html#ac96495884db86cf7ecefb3635f649cd3">compute_adt_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An object containing the filter thresholds. </dd></dl>

</div>
</div>
<a id="a7984fd78d63b52283aeb3be2e2d1e234" name="a7984fd78d63b52283aeb3be2e2d1e234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7984fd78d63b52283aeb3be2e2d1e234">&#9670;&#160;</a></span>compute_adt_qc_filters() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1AdtQcFilters.html">AdtQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_adt_qc_filters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsResults.html">ComputeAdtQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcFiltersOptions.html">ComputeAdtQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metrics</td><td>ADT-based QC metrics from <code><a class="el" href="namespacescran__qc.html#ac96495884db86cf7ecefb3635f649cd3">compute_adt_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An object containing the filter thresholds. </dd></dl>

</div>
</div>
<a id="a47a6f3d70501f5b3bcac0f44cbc82349" name="a47a6f3d70501f5b3bcac0f44cbc82349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47a6f3d70501f5b3bcac0f44cbc82349">&#9670;&#160;</a></span>compute_adt_qc_filters_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1AdtQcBlockedFilters.html">AdtQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_adt_qc_filters_blocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsBuffers.html">ComputeAdtQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcFiltersOptions.html">ComputeAdtQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes filter thresholds for ADT-derived QC metrics in blocked datasets (e.g., cells from multiple batches or samples). Each blocking level has its own thresholds, equivalent to calling <code><a class="el" href="namespacescran__qc.html#a4e0708c006f7362c4ca7587802293e01">compute_adt_qc_filters()</a></code> on the cells from each block. This ensures that uninteresting inter-block differences do not inflate the MAD, see <code><a class="el" href="namespacescran__qc.html#a8e8af19093a60909e202bb614bbacbeb">choose_filter_thresholds_blocked()</a></code> for more details.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>A collection of arrays containing ADT-based QC metrics, filled by <code><a class="el" href="namespacescran__qc.html#ac96495884db86cf7ecefb3635f649cd3">compute_adt_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in \([0, N)\) where \(N\) is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Object containing filter thresholds for each block. </dd></dl>

</div>
</div>
<a id="aeef98343dad6aec5aa287f35fe6a6515" name="aeef98343dad6aec5aa287f35fe6a6515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeef98343dad6aec5aa287f35fe6a6515">&#9670;&#160;</a></span>compute_adt_qc_filters_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1AdtQcBlockedFilters.html">AdtQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_adt_qc_filters_blocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcMetricsResults.html">ComputeAdtQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeAdtQcFiltersOptions.html">ComputeAdtQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>ADT-based QC metrics computed by <code><a class="el" href="namespacescran__qc.html#ac96495884db86cf7ecefb3635f649cd3">compute_adt_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in \([0, N)\) where \(N\) is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Object containing filter thresholds for each block. </dd></dl>

</div>
</div>
<a id="aeee603882324b072b88a6f641ffcc2e6" name="aeee603882324b072b88a6f641ffcc2e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeee603882324b072b88a6f641ffcc2e6">&#9670;&#160;</a></span>choose_filter_thresholds() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran__qc_1_1ChooseFilterThresholdsResults.html">ChooseFilterThresholdsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::choose_filter_thresholds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1FindMedianMadResults.html">FindMedianMadResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html">ChooseFilterThresholdsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We define filter thresholds on the QC metrics by assuming that most cells in the experiment are of high (or at least acceptable) quality. Any outlier values are indicative of low-quality cells that should be filtered out. Given an array of values, outliers are defined as those that are more than some number of median absolute deviations (MADs) from the median value. Outliers can be defined in both directions or just a single direction, depending on the interpretation of the QC metric. We can also apply a log-transformation to the metrics to identify outliers with respect to their fold-change from the median.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mm</td><td>Median and MADc computed by <code><a class="el" href="namespacescran__qc.html#aa258344640d79468c00a2c96c9e1bf1f">find_median_mad()</a></code>. If <code><a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html#a7896ba64781d12a2153a0cbbda3b10d0">ChooseFilterThresholdsOptions::log</a> = true</code>, it is expected that the median and MAD are computed on the log-transformed metrics (i.e., <code><a class="el" href="structscran__qc_1_1FindMedianMadOptions.html#a4706e6f124a7eef17c5a2afc1dd6427d">FindMedianMadOptions::log</a> = true</code>). </td></tr>
    <tr><td class="paramname">options</td><td>Further options. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The upper and lower thresholds derived from <code>mm</code>. </dd></dl>

</div>
</div>
<a id="ae36c76ebd4e27574da1e12241a16d625" name="ae36c76ebd4e27574da1e12241a16d625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae36c76ebd4e27574da1e12241a16d625">&#9670;&#160;</a></span>choose_filter_thresholds() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran__qc_1_1ChooseFilterThresholdsResults.html">ChooseFilterThresholdsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::choose_filter_thresholds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> *&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html">ChooseFilterThresholdsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This overload computes the median and MAD via <code><a class="el" href="namespacescran__qc.html#aa258344640d79468c00a2c96c9e1bf1f">find_median_mad()</a></code> before deriving thresholds with <code><a class="el" href="namespacescran__qc.html#aeee603882324b072b88a6f641ffcc2e6">choose_filter_thresholds()</a></code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for the array indices. </td></tr>
    <tr><td class="paramname">Float_</td><td>Floating-point type for the metrics and thresholds.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of length <code>num</code>, containing a QC metric for each cell. This is modified arbitrarily on output. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The upper and lower thresholds derived from <code>metrics</code>. </dd></dl>

</div>
</div>
<a id="a0d9a36257fb0f4f4a7d9a2f75af17e43" name="a0d9a36257fb0f4f4a7d9a2f75af17e43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d9a36257fb0f4f4a7d9a2f75af17e43">&#9670;&#160;</a></span>choose_filter_thresholds() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran__qc_1_1ChooseFilterThresholdsResults.html">ChooseFilterThresholdsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::choose_filter_thresholds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> *&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html">ChooseFilterThresholdsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran__qc.html#aeee603882324b072b88a6f641ffcc2e6">choose_filter_thresholds()</a></code> that uses an auxiliary buffer to avoid mutating <code>metrics</code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for the array indices. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type for the input data. </td></tr>
    <tr><td class="paramname">Float_</td><td>Floating-point type for the metrics and thresholds.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of length <code>num</code>, containing a QC metric for each cell. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">buffer</td><td>Pointer to an array of length <code>num</code> in which to store intermediate results. Alternatively NULL, in which case a buffer is automatically allocated. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The upper and lower thresholds derived from <code>metrics</code>. </dd></dl>

</div>
</div>
<a id="a8e8af19093a60909e202bb614bbacbeb" name="a8e8af19093a60909e202bb614bbacbeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e8af19093a60909e202bb614bbacbeb">&#9670;&#160;</a></span>choose_filter_thresholds_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsResults.html">ChooseFilterThresholdsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; &gt; scran_qc::choose_filter_thresholds_blocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="structscran__qc_1_1FindMedianMadResults.html">FindMedianMadResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; &gt;&#160;</td>
          <td class="paramname"><em>mms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html">ChooseFilterThresholdsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For datasets with multiple blocks, we can compute block-specific thresholds for each metric. This is equivalent to calling <code><a class="el" href="namespacescran__qc.html#aeee603882324b072b88a6f641ffcc2e6">choose_filter_thresholds()</a></code> on the cells for each block. Our assumption is that differences in the metric distributions between blocks are driven by uninteresting causes (e.g., differences in sequencing depth); variable thresholds can adapt to each block's distribution for effective removal of outliers.</p>
<p>That said, if the differences in the distributions between blocks are interesting, it may be preferable to ignore the blocking factor and just use <code><a class="el" href="namespacescran__qc.html#aeee603882324b072b88a6f641ffcc2e6">choose_filter_thresholds()</a></code> instead. This ensures that the MADs are increased appropriately to avoid filtering out interesting variation.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mms</td><td>Vector of medians and MADs for each block. </td></tr>
    <tr><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector containing the upper and lower thresholds for each block. </dd></dl>

</div>
</div>
<a id="acc052211c623c1226049a2ee24f098fe" name="acc052211c623c1226049a2ee24f098fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc052211c623c1226049a2ee24f098fe">&#9670;&#160;</a></span>choose_filter_thresholds_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsResults.html">ChooseFilterThresholdsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; &gt; scran_qc::choose_filter_thresholds_blocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> *&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">FindMedianMadWorkspace</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; *&#160;</td>
          <td class="paramname"><em>workspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ChooseFilterThresholdsOptions.html">ChooseFilterThresholdsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This overload computes the median and MAD for each block via <code><a class="el" href="namespacescran__qc.html#af2fb034bba1a588f7b007fbf95ffe370">find_median_mad_blocked()</a></code> before deriving thresholds in each block with <code><a class="el" href="namespacescran__qc.html#a8e8af19093a60909e202bb614bbacbeb">choose_filter_thresholds_blocked()</a></code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for the array indices. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type for the input data. </td></tr>
    <tr><td class="paramname">Float_</td><td>Floating-point type for the metrics and thresholds.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of length <code>num</code>, containing a QC metric for each cell. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Optional pointer to an array of block identifiers, see <code><a class="el" href="namespacescran__qc.html#af2fb034bba1a588f7b007fbf95ffe370">find_median_mad_blocked()</a></code> for details. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">workspace</td><td>Pointer to a workspace object, see <code><a class="el" href="namespacescran__qc.html#af2fb034bba1a588f7b007fbf95ffe370">find_median_mad_blocked()</a></code> for details. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector containing the upper and lower thresholds for each block. </dd></dl>

</div>
</div>
<a id="a9d57853e7f9d53acbe63649f19a1ab72" name="a9d57853e7f9d53acbe63649f19a1ab72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d57853e7f9d53acbe63649f19a1ab72">&#9670;&#160;</a></span>compute_crispr_qc_metrics() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a> scran_qc::compute_crispr_qc_metrics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsBuffers.html">ComputeCrisprQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsOptions.html">ComputeCrisprQcMetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a feature-by-cell guide count matrix, this function uses <code><a class="el" href="namespacescran__qc.html#ade78b2da5f4df8f7079570cb5e750513">per_cell_qc_metrics()</a></code> to compute several CRISPR-relevant QC metrics:</p>
<ul>
<li>The sum of counts for each cell. Low counts indicate that the cell was not successfully transfected with a construct, or that library preparation and sequencing failed.</li>
<li>The number of detected guides per cell. In theory, this should be 1, as each cell should express no more than one guide construct. However, ambient contamination may introduce non-zero counts for multiple guides, without necessarily interfering with downstream analyses. As such, this metric is less useful for guide data, though we compute it anyway.</li>
<li>The maximum count in the most abundant guide construct. Low values indicate that the cell was not successfully transfected, or that library preparation and sequencing failed. The identity of the most abundant guide is also reported.</li>
</ul>
<p>We use these metrics to define thresholds for filtering in <code><a class="el" href="namespacescran__qc.html#adf29d5d3e3d5c698710b139f626c8ce0">compute_crispr_qc_filters()</a></code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression.</td></tr>
  </table>
  </dd>
</dl>
<p>Meaningful instances of this object should generally be constructed by calling the <code><a class="el" href="namespacescran__qc.html#a9d57853e7f9d53acbe63649f19a1ab72">compute_crispr_qc_metrics()</a></code> function. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>A <b>tatami</b> matrix containing count data. Rows correspond to CRISPR guides while columns correspond to cells. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td><code><a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsBuffers.html" title="Buffers for compute_crispr_qc_metrics().">ComputeCrisprQcMetricsBuffers</a></code> object in which to store the output. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adbaf45a235b43cb053d64d0106928459" name="adbaf45a235b43cb053d64d0106928459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbaf45a235b43cb053d64d0106928459">&#9670;&#160;</a></span>compute_crispr_qc_metrics() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsResults.html">ComputeCrisprQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; scran_qc::compute_crispr_qc_metrics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsOptions.html">ComputeCrisprQcMetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran__qc.html#a9d57853e7f9d53acbe63649f19a1ab72">compute_crispr_qc_metrics()</a></code> that allocates memory for the results.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat</td><td>A <b>tatami</b> matrix containing counts. Each row should correspond to a guide while each column should correspond to a cell. </td></tr>
    <tr><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An object containing the QC metrics. </dd></dl>

</div>
</div>
<a id="adf29d5d3e3d5c698710b139f626c8ce0" name="adf29d5d3e3d5c698710b139f626c8ce0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf29d5d3e3d5c698710b139f626c8ce0">&#9670;&#160;</a></span>compute_crispr_qc_filters() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1CrisprQcFilters.html">CrisprQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_crispr_qc_filters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsBuffers.html">ComputeCrisprQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcFiltersOptions.html">ComputeCrisprQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>In CRISPR data, low-quality cells are defined as those with a low count for the most abundant guides. However, directly defining a threshold on the maximum count is somewhat tricky as unsuccessful transfection is not uncommon. This often results in a large subpopulation with low maximum counts, inflating the MAD and compromising the threshold calculation. Instead, we use the following approach:</p>
<ol type="1">
<li>Compute the median of the proportion of counts in the most abundant guide (i.e., the maximum proportion),</li>
<li>Subset the cells to only those with maximum proportions above the median.</li>
<li>Define a threshold for low outliers on the log-transformed maximum count within the subset (see <code><a class="el" href="namespacescran__qc.html#aeee603882324b072b88a6f641ffcc2e6">choose_filter_thresholds()</a></code> for details).</li>
</ol>
<p>This assumes that over 50% of cells were successfully transfected with a single guide construct and have high maximum proportions. In contrast, unsuccessful transfections will be dominated by ambient contamination and have low proportions. By taking the subset above the median proportion, we remove all of the unsuccessful transfections and enrich for mostly-high-quality cells. From there, we can apply the usual outlier detection methods on the maximum count, with log-transformation to avoid a negative threshold.</p>
<p>Keep in mind that the maximum proportion is only used to define the subset for threshold calculation. Once the maximum count threshold is computed, they are applied to all cells, regardless of their maximum proportions. This allows us to recover good cells that would have been filtered out by our aggressive median subset. It also ensures that we do not remove cells transfected with multiple guides - such cells are not necessarily uninteresting, e.g., for examining interaction effects, so we will err on the side of caution and leave them in.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramname">metrics</td><td>A collection of arrays containing CRISPR-based QC metrics, filled by <code><a class="el" href="namespacescran__qc.html#a9d57853e7f9d53acbe63649f19a1ab72">compute_crispr_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Object containing filter thresholds. </dd></dl>

</div>
</div>
<a id="a3c7e9cfdd12acb3e582ac5246af5d3eb" name="a3c7e9cfdd12acb3e582ac5246af5d3eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c7e9cfdd12acb3e582ac5246af5d3eb">&#9670;&#160;</a></span>compute_crispr_qc_filters() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1CrisprQcFilters.html">CrisprQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_crispr_qc_filters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsResults.html">ComputeCrisprQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcFiltersOptions.html">ComputeCrisprQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metrics</td><td>CRISPR-based QC metrics from <code><a class="el" href="namespacescran__qc.html#a9d57853e7f9d53acbe63649f19a1ab72">compute_crispr_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Object containing filter thresholds. </dd></dl>

</div>
</div>
<a id="a2be1a5e698e0b3a8f79c3966d971fe81" name="a2be1a5e698e0b3a8f79c3966d971fe81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2be1a5e698e0b3a8f79c3966d971fe81">&#9670;&#160;</a></span>compute_crispr_qc_filters_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1CrisprQcBlockedFilters.html">CrisprQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_crispr_qc_filters_blocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsBuffers.html">ComputeCrisprQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcFiltersOptions.html">ComputeCrisprQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes filter thresholds for CRISPR-derived QC metrics in blocked datasets (e.g., cells from multiple batches or samples). Each blocking level has its own thresholds, equivalent to calling <code><a class="el" href="namespacescran__qc.html#adf29d5d3e3d5c698710b139f626c8ce0">compute_crispr_qc_filters()</a></code> on the cells from each block. This ensures that uninteresting inter-block differences do not inflate the MAD, see <code><a class="el" href="namespacescran__qc.html#a8e8af19093a60909e202bb614bbacbeb">choose_filter_thresholds_blocked()</a></code> for more details.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>A collection of arrays containing CRISPR-based QC metrics, filled by <code><a class="el" href="namespacescran__qc.html#a9d57853e7f9d53acbe63649f19a1ab72">compute_crispr_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in \([0, N)\) where \(N\) is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Object containing filter thresholds for each block. </dd></dl>

</div>
</div>
<a id="aca7f1c65c4e6fc533e4a3ca082e00d3f" name="aca7f1c65c4e6fc533e4a3ca082e00d3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca7f1c65c4e6fc533e4a3ca082e00d3f">&#9670;&#160;</a></span>compute_crispr_qc_filters_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1CrisprQcBlockedFilters.html">CrisprQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_crispr_qc_filters_blocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcMetricsResults.html">ComputeCrisprQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeCrisprQcFiltersOptions.html">ComputeCrisprQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>CRISPR-based QC metrics computed by <code><a class="el" href="namespacescran__qc.html#a9d57853e7f9d53acbe63649f19a1ab72">compute_crispr_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in \([0, N)\) where \(N\) is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Object containing filter thresholds for each block. </dd></dl>

</div>
</div>
<a id="aa258344640d79468c00a2c96c9e1bf1f" name="aa258344640d79468c00a2c96c9e1bf1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa258344640d79468c00a2c96c9e1bf1f">&#9670;&#160;</a></span>find_median_mad() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran__qc_1_1FindMedianMadResults.html">FindMedianMadResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::find_median_mad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> *&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1FindMedianMadOptions.html">FindMedianMadOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pretty much as it says on the can; calculates the median of an array of values first, and uses the median to then compute the median absolute deviation (MAD) from that array.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for array indices. </td></tr>
    <tr><td class="paramname">Float_</td><td>Floating-point type for input and output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of observations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of observations of length <code>num</code>. NaNs are ignored. Array contents are arbitrarily modified on function return and should not be used afterwards. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Median and MAD for <code>metrics</code>, possibly after log-transformation. </dd></dl>

</div>
</div>
<a id="a51ca245d47de05acbb806ae736248d18" name="a51ca245d47de05acbb806ae736248d18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51ca245d47de05acbb806ae736248d18">&#9670;&#160;</a></span>find_median_mad() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran__qc_1_1FindMedianMadResults.html">FindMedianMadResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::find_median_mad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> *&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1FindMedianMadOptions.html">FindMedianMadOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran__qc.html#aa258344640d79468c00a2c96c9e1bf1f">find_median_mad()</a></code> that uses an auxiliary buffer to avoid mutating the input array of values.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for array indices. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type for the input. </td></tr>
    <tr><td class="paramname">Float_</td><td>Floating-point type for output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of observations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of observations of length <code>num</code>. NaNs are ignored. Array contents are arbitrarily modified on function return and should not be used afterwards. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buffer</td><td>Pointer to an array of length <code>num</code>, containing a buffer to use for storing intermediate results. This can also be NULL in which case a buffer is allocated. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Median and MAD for <code>metrics</code>, possibly after log-transformation. </dd></dl>

</div>
</div>
<a id="af2fb034bba1a588f7b007fbf95ffe370" name="af2fb034bba1a588f7b007fbf95ffe370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2fb034bba1a588f7b007fbf95ffe370">&#9670;&#160;</a></span>find_median_mad_blocked()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structscran__qc_1_1FindMedianMadResults.html">FindMedianMadResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a> &gt; &gt; scran_qc::find_median_mad_blocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> *&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">FindMedianMadWorkspace</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; *&#160;</td>
          <td class="paramname"><em>workspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1FindMedianMadOptions.html">FindMedianMadOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For blocked datasets, this function computes the median and MAD for each block. It is equivalent to calling <code><a class="el" href="namespacescran__qc.html#aa258344640d79468c00a2c96c9e1bf1f">find_median_mad()</a></code> separately on all observations from each block.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Output_</td><td>Floating-point type for the output. </td></tr>
    <tr><td class="paramname">Index_</td><td>Integer type for array indices. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type, containing the block IDs. </td></tr>
    <tr><td class="paramname">Value_</td><td>Numeric type for the input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of observations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of observations of length <code>num</code>. NaNs are ignored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Optional pointer to an array of block identifiers. If provided, the array should be of length equal to <code>num</code>. Values should be integer IDs in \([0, N)\) where \(N\) is the number of blocks. If a null pointer is supplied, all observations are assumed to belong to the same block. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">workspace</td><td>Pointer to a workspace object, either (i) constructed on <code>num</code> and <code>block</code> or (ii) configured using <code><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html#aa7d6807c6583a392c042617d9e62ae7a">FindMedianMadWorkspace::set()</a></code> on <code>num</code> and <code>block</code>. The same object can be re-used across multiple calls to <code><a class="el" href="namespacescran__qc.html#af2fb034bba1a588f7b007fbf95ffe370">find_median_mad_blocked()</a></code> with the same <code>num</code> and <code>block</code>. This can also be NULL in which case a new workspace is allocated. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of length \(N\), where each entry contains the median and MAD for each block in <code>block</code>. </dd></dl>

</div>
</div>
<a id="a50cadfe67abc7398be1645988e3be3a7" name="a50cadfe67abc7398be1645988e3be3a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50cadfe67abc7398be1645988e3be3a7">&#9670;&#160;</a></span>filter_index() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a> scran_qc::filter_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> *&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert the filtering vectors produced by <code><a class="el" href="namespacescran__qc.html#af13df69a88ca429bcf8333d61bfb5802">compute_rna_qc_filters()</a></code> and friends into formats that can be used for downstream analysis. In particular, we want to slice the original feature-by-cell matrix so only the high-quality subset of cells are retained. This is most easily done by using <code><a class="elRef" href="https://tatami-inc.github.io/tatami/namespacetatami.html#a77fad1d2a2553899a7860521d6284f50">tatami::make_DelayedSubset()</a></code> to subset the <code><a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a></code> with the indices of the high-quality cells. For this purpose, we can use <code><a class="el" href="namespacescran__qc.html#a50cadfe67abc7398be1645988e3be3a7">filter_index()</a></code> to convert the boolean filtering vector into a vector of sorted and unique column indices.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for array indices. </td></tr>
    <tr><td class="paramname">Keep_</td><td>Boolean type for the filter.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells in the dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filter</td><td>Pointer to an array of length <code>num</code>, indicating whether a cell is of high quality. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>On output, a vector of sorted and unique indices of the cells considered to be high quality. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3afc89c4d5b58f290c88a1992dddaf0f" name="a3afc89c4d5b58f290c88a1992dddaf0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3afc89c4d5b58f290c88a1992dddaf0f">&#9670;&#160;</a></span>filter_index() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; scran_qc::filter_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> *&#160;</td>
          <td class="paramname"><em>filter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran__qc.html#a50cadfe67abc7398be1645988e3be3a7">filter_index()</a></code> that returns a vector directly.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for array indices. </td></tr>
    <tr><td class="paramname">Keep_</td><td>Boolean type for each filter modality.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells in the dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filter</td><td>Pointer to an array of length <code>num</code>, indicating whether a cell is of high quality.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of sorted and unique indices of the cells considered to be high quality. </dd></dl>

</div>
</div>
<a id="a30925d34e2091b9e5fdf2b1cbff866e7" name="a30925d34e2091b9e5fdf2b1cbff866e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30925d34e2091b9e5fdf2b1cbff866e7">&#9670;&#160;</a></span>combine_filters() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a> scran_qc::combine_filters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>filters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a> *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When dealing with multiple filters from different modalities (e.g., <code><a class="el" href="classscran__qc_1_1CrisprQcFilters.html#a9976a82aea3347ebc9e9de71e3635473">CrisprQcFilters::filter()</a></code>, <code><a class="el" href="classscran__qc_1_1AdtQcFilters.html#a6f0d85ffdf2c57adc055925a110764ee">AdtQcFilters::filter()</a></code>), our default strategy is to take the intersection, i.e., we only retain cells that are considered to be high quality in all modalities. This ensures that downstream analyses can be safely performed on each modality in the filtered dataset.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Keep_</td><td>Boolean type for each filter modality. </td></tr>
    <tr><td class="paramname">Output_</td><td>Boolean type for the output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells in the dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filters</td><td>Vector of pointers to arrays of length <code>num</code>. Each array corresponds to a modality and indicates whether each cell is high quality (truthy) or not (falsey) for that modality. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Pointer to an array of length <code>num</code>. On output, this is filled with truthy values only for cells that are high quality in all modalities. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aedcaf6807fab07ce2cbd170a57c84f85" name="aedcaf6807fab07ce2cbd170a57c84f85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedcaf6807fab07ce2cbd170a57c84f85">&#9670;&#160;</a></span>combine_filters() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a>  = uint8_t, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a>  = uint8_t&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Output_</a> &gt; scran_qc::combine_filters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>filters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran__qc.html#a30925d34e2091b9e5fdf2b1cbff866e7">combine_filters()</a></code> that returns a vector directly.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Output_</td><td>Boolean type for the output. </td></tr>
    <tr><td class="paramname">Keep_</td><td>Boolean type for each filter modality.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells in the dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filters</td><td>Vector of pointers to arrays of length <code>num</code>. Each array corresponds to a modality and indicates whether each cell is high quality (truthy) or not (falsey) for that modality.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of length <code>num</code>, indicating which cells are high quality in all modalities. </dd></dl>

</div>
</div>
<a id="a8af35779ffe55f2cb003e5bbed71e175" name="a8af35779ffe55f2cb003e5bbed71e175"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8af35779ffe55f2cb003e5bbed71e175">&#9670;&#160;</a></span>combine_filters_index() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a> scran_qc::combine_filters_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>filters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This has the same behavior as <code><a class="el" href="namespacescran__qc.html#a30925d34e2091b9e5fdf2b1cbff866e7">combine_filters()</a></code> followed by <code><a class="el" href="namespacescran__qc.html#a50cadfe67abc7398be1645988e3be3a7">filter_index()</a></code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for array indices. </td></tr>
    <tr><td class="paramname">Keep_</td><td>Boolean type for each filter modality.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells in the dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filters</td><td>Vector of pointers to arrays of length <code>num</code>. Each array corresponds to a modality and indicates whether each cell is high quality (truthy) or not (falsey) for that modality. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>On output, a vector of sorted and unique indices of the cells considered to be high quality in all modalities. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5dc9944048c61d5befb96a19c04e1b8b" name="a5dc9944048c61d5befb96a19c04e1b8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dc9944048c61d5befb96a19c04e1b8b">&#9670;&#160;</a></span>combine_filters_index() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; scran_qc::combine_filters_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Keep_</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>filters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran__qc.html#a8af35779ffe55f2cb003e5bbed71e175">combine_filters_index()</a></code> that returns a vector directly.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for array indices. </td></tr>
    <tr><td class="paramname">Keep_</td><td>Boolean type for each filter modality.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells in the dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filters</td><td>Vector of pointers to arrays of length <code>num</code>. Each array corresponds to a modality and indicates whether each cell is high quality (truthy) or not (falsey) for that modality.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of sorted and unique indices of the cells considered to be high quality in all modalities. </dd></dl>

</div>
</div>
<a id="ade78b2da5f4df8f7079570cb5e750513" name="ade78b2da5f4df8f7079570cb5e750513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade78b2da5f4df8f7079570cb5e750513">&#9670;&#160;</a></span>per_cell_qc_metrics() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a> scran_qc::per_cell_qc_metrics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1PerCellQcMetricsBuffers.html">PerCellQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1PerCellQcMetricsOptions.html">PerCellQcMetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a feature-by-cell expression matrix (usually containing counts), we compute several QC metrics:</p>
<ul>
<li>The sum of expression values for each cell, which represents the efficiency of library preparation and sequencing. Low sums indicate that the library was not successfully captured.</li>
<li>The number of detected features (i.e., with non-zero counts). This also quantifies the library preparation efficiency, but with a greater focus on capturing the transcriptional complexity.</li>
<li>The maximum value across all features. This is useful in situations where only one feature is expected to be present, e.g., CRISPR guides, hash tags.</li>
<li>The row index of the feature with the maximum count. If multiple features are tied for the maximum count, the earliest feature is reported.</li>
<li>The sum of expression values in pre-defined feature subsets. The exact interpretation depends on the nature of the subset - most commonly, one subset will contain all genes on the mitochondrial chromosome, where higher proportions of counts in the mitochondrial subset indicate cell damage due to loss of cytoplasmic transcripts. Spike-in proportions can be interpreted in a similar manner.</li>
<li>The number of detected features in pre-defined feature subsets. Analogous to the number of detected features for the entire feature space.</li>
</ul>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Floating point type to store the sums. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of detected cells.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>A <b>tatami</b> matrix, typically containing count data. Rows should correspond to features (e.g., genes) while columns should correspond to cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subsets</td><td>Vector of feature subsets, where each entry represents a feature subset and may be either:<ul>
<li>A pointer to an array of length equal to <code>mat.nrow()</code> where each entry is interpretable as a boolean. This indicates whether each row in <code>mat</code> belongs to the subset.</li>
<li>A <code>std::vector</code> containing sorted and unique row indices. This specifies the rows in <code>mat</code> that belong to the subset. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Collection of buffers in which the computed statistics are to be stored. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acdd64a6af25caaab6bef69ccfb26b49c" name="acdd64a6af25caaab6bef69ccfb26b49c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdd64a6af25caaab6bef69ccfb26b49c">&#9670;&#160;</a></span>per_cell_qc_metrics() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran__qc_1_1PerCellQcMetricsResults.html">PerCellQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; scran_qc::per_cell_qc_metrics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1PerCellQcMetricsOptions.html">PerCellQcMetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Floating point type to store the sums. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of detected cells.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>A <b>tatami</b> matrix, typically containing count data. Rows should correspond to features (e.g., genes) while columns should correspond to cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subsets</td><td>Vector of feature subsets, where each entry represents a feature subset and may be either:<ul>
<li>A pointer to an array of length equal to <code>mat.nrow()</code> where each entry is interpretable as a boolean. This indicates whether each row in <code>mat</code> belongs to the subset.</li>
<li>A <code>std::vector</code> containing sorted and unique row indices. This specifies the rows in <code>mat</code> that belong to the subset. </li>
</ul>
</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Object containing the QC metrics. Not all metrics may be computed depending on <code>options</code>. </dd></dl>

</div>
</div>
<a id="a11547d21005ac59afdfa595581c534bc" name="a11547d21005ac59afdfa595581c534bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11547d21005ac59afdfa595581c534bc">&#9670;&#160;</a></span>compute_rna_qc_metrics() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">void</a> scran_qc::compute_rna_qc_metrics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsBuffers.html">ComputeRnaQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsOptions.html">ComputeRnaQcMetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a feature-by-cell RNA count matrix, we compute several metrics for filtering high-quality cells:</p>
<ul>
<li>The total sum of counts for each cell, which represents the efficiency of library preparation and sequencing. Low totals indicate that the library was not successfully captured.</li>
<li>The number of detected features. This also quantifies the library preparation efficiency, but with a greater focus on capturing the transcriptional complexity.</li>
<li>The proportion of counts in pre-defined feature subsets, the exact interpretation of which depends on the nature of the subset. Typically, one subset contains all genes on the mitochondrial chromosome, where higher proportions are representative of cell damage; the assumption is that cytoplasmic transcripts leak through tears in the cell membrane while the mitochondria are still trapped inside. The prportion of spike-in transcripts can be interpreted in a similar manner, where the loss of endogenous transcripts results in higher spike-in proportions.</li>
</ul>
<p>We use these metrics to define thresholds for filtering in <code><a class="el" href="namespacescran__qc.html#af13df69a88ca429bcf8333d61bfb5802">compute_rna_qc_filters()</a></code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>A <b>tatami</b> matrix containing counts. Rows should correspond to genes while columns should correspond to cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subsets</td><td>Vector of feature subsets, typically mitochondrial genes or spike-in transcripts. See <code><a class="el" href="namespacescran__qc.html#ade78b2da5f4df8f7079570cb5e750513">per_cell_qc_metrics()</a></code> for more details on the expected format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Collection of buffers in which to store the output. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a10981f9d0493eb03130bc2985ce702ff" name="a10981f9d0493eb03130bc2985ce702ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10981f9d0493eb03130bc2985ce702ff">&#9670;&#160;</a></span>compute_rna_qc_metrics() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a>  = const uint8_t*&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsResults.html">ComputeRnaQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; scran_qc::compute_rna_qc_metrics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Value_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Index_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> std::vector&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Subset_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsOptions.html">ComputeRnaQcMetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran__qc.html#a11547d21005ac59afdfa595581c534bc">compute_rna_qc_metrics()</a></code> that allocates memory for the results.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>A <b>tatami</b> matrix containing counts. Rows should correspond to genes while columns should correspond to cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subsets</td><td>Vector of feature subsets, typically mitochondrial genes or spike-in transcripts. See <code><a class="el" href="namespacescran__qc.html#ade78b2da5f4df8f7079570cb5e750513">per_cell_qc_metrics()</a></code> for more details on the expected format. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An object containing the QC metrics. Subset proportions are returned depending on the <code>subsets</code>. </dd></dl>

</div>
</div>
<a id="af13df69a88ca429bcf8333d61bfb5802" name="af13df69a88ca429bcf8333d61bfb5802"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af13df69a88ca429bcf8333d61bfb5802">&#9670;&#160;</a></span>compute_rna_qc_filters() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a>  = double&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1RnaQcFilters.html">RnaQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_rna_qc_filters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsBuffers.html">ComputeRnaQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcFiltersOptions.html">ComputeRnaQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Using the RNA-relevant QC metrics from <code><a class="el" href="namespacescran__qc.html#a11547d21005ac59afdfa595581c534bc">compute_rna_qc_metrics()</a></code>, we consider low-quality cells to be those with a low sum, a low number of detected genes, and high subset proportions. we define thresholds for each metric using an MAD-based outlier approach. For the total counts and number of detected features, the outliers are defined after log-transformation of the metrics.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramname">metrics</td><td>A collection of buffers containing RNA-based QC metrics, filled by <code><a class="el" href="namespacescran__qc.html#a11547d21005ac59afdfa595581c534bc">compute_rna_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An object containing the filter thresholds. </dd></dl>

</div>
</div>
<a id="a661f34a170913e18ce0e23e82b83899a" name="a661f34a170913e18ce0e23e82b83899a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a661f34a170913e18ce0e23e82b83899a">&#9670;&#160;</a></span>compute_rna_qc_filters() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>  = int, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a>  = double&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1RnaQcFilters.html">RnaQcFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_rna_qc_filters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsResults.html">ComputeRnaQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcFiltersOptions.html">ComputeRnaQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes filter thresholds for RNA-derived QC metrics in blocked datasets (e.g., cells from multiple batches or samples). Each blocking level has its own thresholds, equivalent to calling <code><a class="el" href="namespacescran__qc.html#af13df69a88ca429bcf8333d61bfb5802">compute_rna_qc_filters()</a></code> on the cells from each block. This ensures that uninteresting inter-block differences do not inflate the MAD, see <code><a class="el" href="namespacescran__qc.html#a8e8af19093a60909e202bb614bbacbeb">choose_filter_thresholds_blocked()</a></code> for more details.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metrics</td><td>RNA-based QC metrics from <code><a class="el" href="namespacescran__qc.html#a11547d21005ac59afdfa595581c534bc">compute_rna_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An object containing the filter thresholds. </dd></dl>

</div>
</div>
<a id="ad3ce8f1830515304cde4417dd26cb8a6" name="ad3ce8f1830515304cde4417dd26cb8a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3ce8f1830515304cde4417dd26cb8a6">&#9670;&#160;</a></span>compute_rna_qc_filters_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1RnaQcBlockedFilters.html">RnaQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_rna_qc_filters_blocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">size_t</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsBuffers.html">ComputeRnaQcMetricsBuffers</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcFiltersOptions.html">ComputeRnaQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>A collection of buffers containing RNA-based QC metrics, filled by <code><a class="el" href="namespacescran__qc.html#a11547d21005ac59afdfa595581c534bc">compute_rna_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in \([0, N)\) where \(N\) is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Object containing filter thresholds for each block. </dd></dl>

</div>
</div>
<a id="ad6123dbe90d91d7c6bf8200ed582e10f" name="ad6123dbe90d91d7c6bf8200ed582e10f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6123dbe90d91d7c6bf8200ed582e10f">&#9670;&#160;</a></span>compute_rna_qc_filters_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a>  = double, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> , <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">typename</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran__qc_1_1RnaQcBlockedFilters.html">RnaQcBlockedFilters</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Float_</a> &gt; scran_qc::compute_rna_qc_filters_blocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcMetricsResults.html">ComputeRnaQcMetricsResults</a>&lt; <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Sum_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Detected_</a>, <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Proportion_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">Block_</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran__qc_1_1FindMedianMadWorkspace.html">const</a> <a class="el" href="structscran__qc_1_1ComputeRnaQcFiltersOptions.html">ComputeRnaQcFiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>RNA-based QC metrics computed by <code><a class="el" href="namespacescran__qc.html#a11547d21005ac59afdfa595581c534bc">compute_rna_qc_metrics()</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in \([0, N)\) where \(N\) is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Object containing filter thresholds for each block. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
